<div id='<%= obj.id %>' class='source'>

<div class='keyline-bottom contain pad2y pad1x'>
  <h4><%= obj.name || 'Untitled' %></h4>
  <div class='pin-right pad1 sourcetype <%= obj.tiles ? 'remote' : 'local' %>'>
    <div class='pill pad0y'>
      <% if (obj.tiles) { %>
      <a name='remote' class='button short quiet'>Remote</a><!--
      --><a class='button short icon refresh recache' href='#recache'></a>
      <% } else { %>
      <a name='local' class='button short quiet'>Local</span><!--
      --><a class='button short icon refresh recache' href='#recache'></a>
      <% } %>
    </div>
  </div>
</div>

<!--
@TODO currently this button is a trap as it can leave a style in a state
with no sources. Once vector tile compositing is available revisit.
<a class='delete icon close' href='#delete'></a>
-->

<% _(obj.vector_layers).chain().clone().reverse().each(function(l) { %>
<span class='small layer col12 quiet truncate contain keyline-bottom pad1' id='layers-<%=l.id%>'>
<a class='inline col12 row1 pin-top' href='#layers-<%=l.id%>'></a>
  <span class='document icon <%=l.geometry||'unknown'%>'></span>
  <%=l.id%>
  <div class='pin-right pad0'>
    <span class='zooms pad0 fill-darken1 round small'>
      <% if (!l.maxzoom) { %>
      z<%= l.minzoom||0 %>+
      <% } else { %>
      z<%= l.minzoom||0 %>-<%= l.maxzoom||22 %>
      <% } %>
    </span>
  </div>
  <small class='truncate col12 pad1y'><%=l.description||'No description.'%></small>
  <% _(l.fields||{}).each(function(desc,name) { %>
  <small class='field quiet space-bottom0'><code class='fl inline'><%=name%></code><%=desc||'No description.'%></small>
  <% }); %>
</span>
<% }); %>
</div>
