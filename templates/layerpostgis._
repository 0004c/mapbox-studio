<form class='pane scroll-styled editor dark w2 l2' id='layers-<%=obj.id%>'>
  <nav class='keyline-bottom row1'>
    <span class='pad0y fr pad4x pill'><!--
      --><a href='#mode-conf' class='quiet button short icon levels'></a><!--
      --><a href='#mode-fields' class='quiet button short icon book'></a><!--
      --><a href='#mode-sql' class='quiet button short icon pencil'></a>
    </span>
    <a href='#' class='pin-topright quiet inline pad1 icon close'></a>
  </nav>
  <section class='pad2x pad1y pin-topleft'>
    <h3>
      <%= obj.id %>
    </h3>
    <input type='hidden' name='id' value='<%=obj.id%>' />
  </section>

  <fieldset class='pad2 conf'>
    <section>
      <label>Description</label>
      <input class='stretch' type='text' name='description' value='<%= _(obj.description).escape() %>' />
    </section>
    <section>
      <label>PostGIS<label>
      <div class='pill'><!--
        --><input type='text' name='Datasource-user' class='w1' value='<%= obj.Datasource.user %>' /><!--
        --><label class='ghost'>user</label><!--
        --><input type='text' name='Datasource-dbname' class='w1' value='<%= obj.Datasource.dbname %>' /><!--
        --><label class='ghost'>db</label><!--
        --><input type='text' name='Datasource-host' class='w1' value='<%= obj.Datasource.host %>' /><!--
        --><label class='ghost'>host</label><!--
        --><input type='text' name='Datasource-port' class='w1 last' value='<%= obj.Datasource.port %>' /><!--
        --><label class='ghost'>port</label>
      </div>
      <input type='hidden' name='Datasource-type' value='postgis' />
      <input type='hidden' name='Datasource-max_size' value='512' />
    </section>
    <section>
      <label class='inline'>Extent</label><input type='text' name='Datasource-extent' value='<%= obj.Datasource.extent %>' placeholder='autodetect' />
    </section>
    <%= this.layerconf(obj) %>
    <% if (obj.properties['group-by']) { %>
    <input type='hidden' name='properties-group-by' value='<%=obj.properties['group-by']%>' />
    <% } %>
    <section class='pad2'>
      <a href='#' class='button submit margin6 col6'>Done</a>
    </section>
  </fieldset>

  <div class='fields'><%= this.layerfields(obj.vt.fields) %></div>

  <div class='sql'>
    <section>
      <span class='pill'><!--
        --><input name='Datasource-geometry_field' class='w13' type='text' value='<%= obj.Datasource['geometry_field'] || '' %>'/><!--
        --><label class='ghost'>geom field</label><!--
        --><input name='Datasource-geometry_table' class='w13' type='text' value='<%= obj.Datasource['geometry_table'] || '' %>'/><!--
        --><label class='ghost'>geom table</label><!--
        --><input name='Datasource-key_field' class='w13 last' size='20' type='text' value='<%= obj.Datasource['key_field'] || '' %>' /><!--
        --><label class='ghost'>key</label>
      </span>
    </section>
  </div>
</form>
