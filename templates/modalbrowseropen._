<%
// Required vars
// - type, one of style/source
// - cwd, absolute path from which to begin browsing
%>
<% print(this.modalbrowser({
  id: 'browse' + obj.type,
  cwd: obj.cwd,
  label: 'Open',
  hint: 'Letters and numbers only',
  placeholder: type + ' name',
  pattern: '[\\w+\\d+\\s\\.-]+'
})); %>
<script>
new views.Browser({
  el: $('#browse<%=type%>'),
  filter: function(file) { return file.type === 'dir' || /\.tm2$/.test(file.basename) },
  isFile: function(file) { return /\.tm2$/.test(file) },
  callback: function(err, filepath) {
    if (err) return false; // @TODO
    filepath = filepath.split(' ').join('_');
    filepath = filepath.replace(/.tm2/, '') + '.tm2';
    window.location = '/<%=type%>?id=tm<%=type%>://' + filepath;
    return false;
  }
});
</script>
